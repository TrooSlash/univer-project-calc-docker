# 🧮 Калькулятор с CI/CD Pipeline

[![CI/CD Pipeline](https://github.com/TrooSlash/univer-project-calc-docker/workflows/CI/CD%20Pipeline/badge.svg)](https://github.com/TrooSlash/univer-project-calc-docker/actions)
[![Python Version](https://img.shields.io/badge/python-3.11+-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Docker](https://img.shields.io/badge/docker-ready-brightgreen.svg)](https://hub.docker.com/r/coofol/calculator-app)

Современное десктопное приложение-калькулятор на Python с PySide6, демонстрирующее профессиональные практики разработки ПО, включая автоматизированное тестирование, непрерывную интеграцию/развертывание и контейнеризацию.

> 📚 **Университетский проект**: Разработан в рамках курсовой работы для демонстрации современных DevOps практик и принципов разработки программного обеспечения.

---

## 📖 Содержание

- [О проекте](#о-проекте)
- [Возможности](#возможности)
- [Технологический стек](#технологический-стек)
- [Быстрый старт](#быстрый-старт)
  - [Требования](#требования)
  - [Установка](#установка)
  - [Локальный запуск](#локальный-запуск)
  - [Запуск в Docker](#запуск-в-docker)
- [Тестирование](#тестирование)
- [CI/CD Pipeline](#cicd-pipeline)
- [Структура проекта](#структура-проекта)
- [Разработка](#разработка)
- [Вклад в проект](#вклад-в-проект)
- [Лицензия](#лицензия)
- [Контакты](#контакты)

---

## 📝 О проекте

Данный проект демонстрирует полный цикл разработки программного обеспечения - от написания кода до развертывания. Он служит практическим примером реализации:

- **Чистой архитектуры кода**: Хорошо структурированный, поддерживаемый код на Python
- **Test-Driven Development**: Комплексное модульное тестирование с высоким покрытием
- **Непрерывной интеграции**: Автоматизированное тестирование и проверка качества кода
- **Непрерывного развертывания**: Автоматическая сборка и публикация Docker образов
- **Контейнеризации**: Полная поддержка Docker с мультиплатформенной совместимостью
- **Кроссплатформенного GUI**: Современный десктопный интерфейс на Qt (PySide6)

Калькулятор предоставляет базовые арифметические операции и служит надежным примером профессиональных рабочих процессов разработки ПО.

---

## ✨ Возможности

### Основной функционал
- ✅ **Базовые арифметические операции**: Сложение, вычитание, умножение, деление
- ✅ **Десятичные числа**: Полная поддержка вычислений с плавающей точкой
- ✅ **Смена знака**: Изменение знака числа кнопкой ±
- ✅ **Backspace**: Удаление последней введенной цифры
- ✅ **Функции очистки**: CE (очистка ввода) и C (полная очистка)
- ✅ **Обработка ошибок**: Корректная обработка деления на ноль и некорректных операций

### Технические возможности
- 🧪 **Комплексное тестирование**: Полное покрытие модульными тестами с pytest
- 🔄 **CI/CD Pipeline**: Автоматизированное тестирование, линтинг, сборка и развертывание
- 🐳 **Поддержка Docker**: Контейнеризованное приложение с поддержкой GUI через WSLg/X11
- 🎨 **Современный интерфейс**: Чистый, интуитивный UI на PySide6 (Qt 6.x)
- 📊 **Качество кода**: Автоматический линтинг с Flake8 и Pylint
- 🚀 **Кроссплатформенность**: Совместимость с Windows, Linux и macOS

---

## 🛠️ Технологический стек

| Компонент | Технология |
|-----------|-----------|
| **Язык программирования** | Python 3.11+ |
| **GUI Framework** | PySide6 (Qt 6.x) |
| **Тестирование** | pytest, pytest-qt |
| **Качество кода** | Flake8, Pylint |
| **CI/CD** | GitHub Actions |
| **Контейнеризация** | Docker, Docker Compose |
| **Система контроля версий** | Git, GitHub |

---

## 🚀 Быстрый старт

### Требования

Перед началом убедитесь, что у вас установлено:

- **Python 3.11 или выше** - [Скачать Python](https://www.python.org/downloads/)
- **Git** - [Скачать Git](https://git-scm.com/downloads)
- **Docker** (опционально, для контейнерного развертывания) - [Скачать Docker](https://www.docker.com/get-started)

Для поддержки GUI в Windows с Docker необходимо:
- **Windows 11** с WSLg (рекомендуется) - встроенная поддержка X11
- ИЛИ **VcXsrv** / **X410** для X11 forwarding на Windows 10

### Установка

1. **Клонируйте репозиторий**
   ```bash
   git clone https://github.com/TrooSlash/univer-project-calc-docker.git
   cd univer-project-calc-docker
   ```

2. **Создайте виртуальное окружение**
   ```bash
   python -m venv .venv
   ```

3. **Активируйте виртуальное окружение**
   
   **Windows (PowerShell):**
   ```powershell
   .\.venv\Scripts\Activate.ps1
   ```
   
   **Windows (CMD):**
   ```cmd
   .venv\Scripts\activate.bat
   ```
   
   **Linux/macOS:**
   ```bash
   source .venv/bin/activate
   ```

4. **Установите зависимости**
   ```bash
   pip install -r requirements.txt
   ```

### Локальный запуск

Просто запустите скрипт калькулятора:

```bash
python calculator.py
```

Откроется окно калькулятора с интуитивно понятным интерфейсом.

### Запуск в Docker

#### Вариант 1: Загрузка с Docker Hub

```bash
docker pull coofol/calculator-app:latest
```

#### Вариант 2: Локальная сборка

```bash
docker build -t calculator-app .
```

#### Запуск контейнера

**На Windows 11 с WSLg (рекомендуется):**
```powershell
.\run-gui-wslg.ps1
```

**На Linux:**
```bash
# Разрешить подключения к X server
xhost +local:docker

# Запустить контейнер
docker run --rm \
  -e DISPLAY=$DISPLAY \
  -v /tmp/.X11-unix:/tmp/.X11-unix \
  coofol/calculator-app:latest

# После использования отозвать доступ
xhost -local:docker
```

**С Docker Compose:**
```bash
docker-compose up
```

> 📖 Подробные инструкции по настройке GUI на разных платформах см. в [GUI-LAUNCH.md](GUI-LAUNCH.md)

---

## 🧪 Тестирование

Проект поддерживает высокое качество кода благодаря комплексному автоматизированному тестированию.

### Запуск всех тестов

```bash
pytest
```

### Запуск тестов с отчетом о покрытии

```bash
pytest --cov=calculator --cov-report=term --cov-report=html
```

### Подробный вывод тестов

```bash
pytest -v
```

### Структура тестов

- `test_calculator.py` - Комплексные модульные тесты для логики калькулятора
- Тесты покрывают все арифметические операции и граничные случаи
- Тестирование GUI взаимодействий с pytest-qt
- Проверка деления на ноль и обработки ошибок
- Тесты операций очистки и функции backspace

**Покрытие кода: Высокое** ✅

---

## 🔄 CI/CD Pipeline

Проект реализует полный CI/CD pipeline с использованием GitHub Actions, автоматически запускаемый при изменении кода.

### Архитектура Pipeline

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│ Тестирование│────▶│  Линтинг    │────▶│   Сборка    │────▶│Развертывание│
│  (pytest)   │     │(flake8/pyl) │     │   Docker    │     │  (Hub Push) │
└─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘
```

### Детали workflow

**Триггеры:**
- Push в ветки `main` или `develop`
- Pull requests в ветки `main` или `develop`

**Задачи Pipeline:**

1. **Запуск тестов**
   - Выполнение pytest с отчетом о покрытии
   - Установка системных зависимостей для PySide6
   - Генерация отчетов о покрытии

2. **Проверка качества кода**
   - Запуск Flake8 для проверки стиля кода
   - Запуск Pylint для анализа кода
   - Продолжение работы при некритичных предупреждениях

3. **Сборка Docker образа**
   - Сборка мультиплатформенного Docker образа
   - Тегирование по commit SHA и имени ветки
   - Кеширование слоев для ускорения сборки

4. **Развертывание в реестр**
   - Аутентификация в Docker Hub
   - Push тегированных образов в реестр
   - Только для ветки main (не для PR)

Посмотреть полную конфигурацию workflow: [`.github/workflows/main.yml`](.github/workflows/main.yml)

### Настройка CI/CD

Для активации автоматического развертывания в Docker Hub:

1. Создайте токен доступа Docker Hub на https://hub.docker.com/settings/security
2. Добавьте секреты репозитория в GitHub Settings → Secrets and variables → Actions:
   - `DOCKER_USERNAME`: Ваше имя пользователя Docker Hub
   - `DOCKER_PASSWORD`: Ваш токен доступа Docker Hub (не пароль!)

---

## 📁 Структура проекта

```
univer-project-calc-docker/
│
├── .github/
│   └── workflows/
│       └── main.yml              # Конфигурация CI/CD pipeline
│
├── calculator.py                 # Основной код приложения
├── test_calculator.py            # Модульные тесты
├── requirements.txt              # Зависимости Python
│
├── Dockerfile                    # Определение Docker образа
├── docker-compose.yml            # Конфигурация Docker Compose
├── .gitignore                    # Правила игнорирования Git
│
├── run-gui-wslg.ps1             # Скрипт запуска GUI для Windows
├── GUI-LAUNCH.md                # Документация по настройке GUI
│
├── LICENSE                       # Лицензия MIT
└── README.md                     # Документация проекта
```

---

## 💻 Разработка

### Стандарты стиля кода

Проект следует руководству по стилю PEP 8 с автоматической проверкой:

- **Flake8** - Проверка соответствия стилю (макс. длина строки: 100)
- **Pylint** - Комплексный анализ кода и проверка качества

### Запуск проверки качества кода

```bash
# Запуск Flake8
flake8 calculator.py --max-line-length=100

# Запуск Pylint
pylint calculator.py --disable=C0111,C0103
```

### Процесс разработки

1. **Создайте ветку для фичи:**
   ```bash
   git checkout -b feature/название-фичи
   ```

2. **Внесите изменения и убедитесь, что тесты проходят:**
   ```bash
   pytest
   ```

3. **Запустите линтеры для проверки качества кода:**
   ```bash
   flake8 calculator.py
   pylint calculator.py
   ```

4. **Закоммитьте изменения:**
   ```bash
   git add .
   git commit -m "Add: описательное сообщение коммита"
   ```

5. **Отправьте в свой fork:**
   ```bash
   git push origin feature/название-фичи
   ```

6. **Создайте Pull Request** на GitHub

### Соглашение о сообщениях коммитов

Следуйте семантическим сообщениям коммитов:
- `Add:` - Новая функция или функциональность
- `Fix:` - Исправление ошибки
- `Update:` - Обновление существующей функциональности
- `Refactor:` - Рефакторинг кода
- `Docs:` - Изменения в документации
- `Test:` - Добавление или обновление тестов

---

## 🤝 Вклад в проект

Вклад приветствуется! Чтобы внести вклад в проект:

1. **Сделайте Fork** репозитория
2. **Создайте** ветку для фичи (`git checkout -b feature/AmazingFeature`)
3. **Закоммитьте** изменения (`git commit -m 'Add some AmazingFeature'`)
4. **Отправьте** в ветку (`git push origin feature/AmazingFeature`)
5. **Откройте** Pull Request

Пожалуйста, убедитесь:
- Все тесты проходят (`pytest`)
- Код соответствует стандартам стиля (`flake8`, `pylint`)
- Сообщения коммитов понятны и описательны
- Документация обновлена при необходимости

---

## 🎮 Руководство пользователя

### Операции калькулятора

| Кнопка | Функция |
|--------|---------|
| **0-9** | Ввод цифр |
| **+, -, ×, ÷** | Арифметические операции |
| **=** | Вычислить результат |
| **.** | Десятичная точка |
| **C** | Очистить всё (сброс калькулятора) |
| **CE** | Очистить ввод (очистка текущего ввода) |
| **←** | Backspace (удалить последнюю цифру) |
| **±** | Переключить знак (положительное/отрицательное) |

### Примеры операций

```
Базовые вычисления:    5 + 3 = 8
Десятичные числа:      3.14 × 2 = 6.28
Отрицательные числа:   5 - 8 = -3
Смена знака:           5 [±] = -5
Цепочки операций:      2 + 3 × 4 = 20
```

---

## 📄 Лицензия

Проект распространяется под лицензией MIT - см. файл [LICENSE](LICENSE) для деталей.

---

## 👤 Автор

**TrooSlash**

- GitHub: [@TrooSlash](https://github.com/TrooSlash)
- Проект: [univer-project-calc-docker](https://github.com/TrooSlash/univer-project-calc-docker)
- Docker Hub: [coofol/calculator-app](https://hub.docker.com/r/coofol/calculator-app)

---

## 🙏 Благодарности

Проект стал возможен благодаря:

- **Команде PySide6** - За отличные привязки Qt 6 для Python
- **GitHub** - За платформу CI/CD Actions
- **Docker** - За технологию контейнеризации
- **Сообществу pytest** - За комплексный фреймворк тестирования
- **Python Software Foundation** - За язык программирования Python

Особая благодарность open-source сообществу за предоставление инструментов и фреймворков, делающих современную разработку ПО эффективной и удобной.

---

## 📚 Дополнительные ресурсы

- [Документация PySide6](https://doc.qt.io/qtforpython/)
- [Документация pytest](https://docs.pytest.org/)
- [Документация Docker](https://docs.docker.com/)
- [Документация GitHub Actions](https://docs.github.com/actions)

---

<div align="center">

**⭐ Если проект оказался полезным, пожалуйста, поставьте звезду!**

Сделано с ❤️ для образовательных целей

</div>
